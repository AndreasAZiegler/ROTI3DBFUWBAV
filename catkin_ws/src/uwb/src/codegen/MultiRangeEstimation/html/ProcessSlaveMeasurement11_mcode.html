<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="comment">%% Compute clock offset and skew of slave UWB unit</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S50T3U286">clock_offset</span>, <span class="var type1" id="S51T3U287">clock_skew</span>] = ProcessSlaveMeasurement( <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">    <span class="var type1" id="S52T3U290">range</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">    <span class="var type1" id="S53T3U291">timestamp_master_request_1_recv</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="var type1" id="S54T3U292">timestamp_master_request_2_recv</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">    <span class="var type1" id="S55T1U293">timestamp_master_request_1_array</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">    <span class="var type1" id="S56T1U294">timestamp_master_request_2_array</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">    <span class="var type1" id="S57T4U295">params</span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">)</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">    <span class="comment">% clock offset</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">    <span class="mxinfo " id="T3:U9"><span class="var type1" id="S58T3U298">timestamp_master</span> = <span class="mxinfo " id="T3:U11"><span class="var type1" id="S55T1U300">timestamp_master_request_1_array</span>(<span class="mxinfo " id="T3:U13">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">    <span class="mxinfo " id="T3:U14"><span class="var type1" id="S59T3U304">timestamp_slave</span> = <span class="var type1" id="S53T3U305">timestamp_master_request_1_recv</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo " id="T3:U17"><span class="var type1" id="S50T3U308">clock_offset</span> = <span class="mxinfo " id="T3:U19"><span class="mxinfo " id="T3:U20"><span class="var type1" id="S59T3U311">timestamp_slave</span> - <span class="var type1" id="S58T3U312">timestamp_master</span></span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">        - <span class="mxinfo " id="T3:U23"><span class="var type1" id="S52T3U314">range</span> / <span class="mxinfo " id="T3:U25"><span class="var type1" id="S57T4U316">params</span>.SPEED_OF_LIGHT_IN_M_PER_DW_TIMEUNIT</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">    <span class="comment">% clock skew</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo " id="T3:U27"><span class="var type1" id="S60T3U320">clock_diff_1</span> = <span class="mxinfo " id="T3:U29"><span class="fcn" id="F2N3:B322">ConvertDWTimeunitsToMicroseconds</span>( <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">        <span class="mxinfo " id="T3:U30"><span class="mxinfo " id="T3:U31"><span class="var type1" id="S56T1U325">timestamp_master_request_2_array</span>(<span class="mxinfo " id="T3:U33">1</span>)</span> - <span class="mxinfo " id="T3:U34"><span class="var type1" id="S55T1U328">timestamp_master_request_1_array</span>(<span class="mxinfo " id="T3:U36">1</span>)</span></span>, <span class="var type1" id="S57T4U330">params</span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo " id="T3:U38"><span class="var type1" id="S62T3U333">clock_diff_2</span> = <span class="mxinfo " id="T3:U40"><span class="fcn" id="F2N3:B335">ConvertDWTimeunitsToMicroseconds</span>( <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">        <span class="mxinfo " id="T3:U41"><span class="var type1" id="S54T3U337">timestamp_master_request_2_recv</span> - <span class="var type1" id="S53T3U338">timestamp_master_request_1_recv</span></span>, <span class="var type1" id="S57T4U339">params</span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo " id="T3:U45"><span class="var type1" id="S51T3U342">clock_skew</span> = <span class="mxinfo " id="T3:U47">(<span class="mxinfo " id="T3:U48"><span class="mxinfo " id="T3:U49"><span class="mxinfo " id="T3:U50">1</span> / <span class="var type1" id="S62T3U348">clock_diff_2</span></span> - <span class="mxinfo " id="T3:U52"><span class="mxinfo " id="T3:U53">1</span> / <span class="var type1" id="S60T3U351">clock_diff_1</span></span></span>) / (<span class="mxinfo " id="T3:U55"><span class="mxinfo " id="T3:U56">1</span> / <span class="var type1" id="S60T3U355">clock_diff_1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"><span class="comment">%% Compute clock offset and skew of secondary UWB unit</span></span></span>
</pre>
